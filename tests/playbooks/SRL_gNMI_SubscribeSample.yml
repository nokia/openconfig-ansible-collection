---
- name: Nokia SRL Streaming Telemetry
  gather_facts: false
  hosts: nokia_srlinux

  vars:
    ansible_connection: nokia.openconfig.gnmi

  tasks:
  - name: gNMI streaming telemetry
    nokia.openconfig.gnmi_subscribe:
      duration: 5
      mode: STREAM
      subscription:
        - path: /interface[name=*]/statistics
          mode: SAMPLE
          sampleInterval: '1000000000'
    register: testout

  - name: dump test output
    debug:
      msg: {{ testout.output | from_json }}

